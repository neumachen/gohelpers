workspace:
  base: /go
  path: src/github.com/ParaServices/paralog

matrix:
  TAG:
    - 1.9-alpine
    - 1.9.7-alpine
    - 1.10-alpine

pipeline:
  notify_start:
    image: plugins/slack
    webhook: https://hooks.slack.com/services/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
    channel: ci
    username: drone
    template: "<{{ build.link }}|Build #{{ build.number }} started> on <http://github.com/{{ repo.owner }}/{{ repo.name }}/tree/{{ build.branch }}|{{ repo.name }}:{{ build.branch }}> by @{{ build.author }}"

  build:
    image: golang:${TAG}
    commands:
      - go build ./...

  # semver:
  #   image: alpine:3.6
  #   commands:
  #     - apk update && apk add bash git curl
  #     - curl https://gist.githubusercontent.com/lxhunter/9d4310462b6972a3f57b5f914543fd51/raw/semver.sh | bash
  #   when:
  #     branch: master

  notify_finish:
    image: plugins/slack
    webhook: https://hooks.slack.com/services/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
    channel: ci
    username: drone
    template: "<{{ build.link }}|Build #{{ build.number }} {{ build.status }}> on <http://github.com/{{ repo.owner }}/{{ repo.name }}/tree/{{ build.branch }}|{{ repo.name }}:{{ build.branch }}> by @{{ build.author }}"
    when:
      status: [ success, failure ]
